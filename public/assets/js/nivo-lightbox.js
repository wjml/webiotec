!function($,window,document,undefined){var pluginName="nivoLightbox",defaults={effect:"fade",theme:"default",keyboardNav:!0,clickImgToClose:!1,clickOverlayToClose:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(lightbox){},beforeHideLightbox:function(){},afterHideLightbox:function(){},beforePrev:function(element){},onPrev:function(element){},beforeNext:function(element){},onNext:function(element){},errorMessage:"The requested content cannot be loaded. Please try again later."};function NivoLightbox(element,options){this.el=element,this.$el=$(this.el),this.options=$.extend({},defaults,options),this._defaults=defaults,this._name=pluginName,this.init()}NivoLightbox.prototype={init:function(){var $this=this;$("html").hasClass("nivo-lightbox-notouch")||$("html").addClass("nivo-lightbox-notouch"),"ontouchstart"in document&&$("html").removeClass("nivo-lightbox-notouch"),this.$el.on("click",(function(e){$this.showLightbox(e)})),this.options.keyboardNav&&$("body").off("keyup").on("keyup",(function(e){var code=e.keyCode?e.keyCode:e.which;27==code&&$this.destructLightbox(),37==code&&$(".nivo-lightbox-prev").trigger("click"),39==code&&$(".nivo-lightbox-next").trigger("click")})),this.options.onInit.call(this)},showLightbox:function(e){var $this=this,currentLink=this.$el,check;if(this.checkContent(currentLink)){e.preventDefault(),this.options.beforeShowLightbox.call(this);var lightbox=this.constructLightbox();if(lightbox){var content=lightbox.find(".nivo-lightbox-content");if(content){if($("body").addClass("nivo-lightbox-body-effect-"+this.options.effect),this.processContent(content,currentLink),this.$el.attr("data-lightbox-gallery")){var galleryItems=$('[data-lightbox-gallery="'+this.$el.attr("data-lightbox-gallery")+'"]');$(".nivo-lightbox-nav").show(),$(".nivo-lightbox-prev").off("click").on("click",(function(e){e.preventDefault();var index=galleryItems.index(currentLink);currentLink=galleryItems.eq(index-1),$(currentLink).length||(currentLink=galleryItems.last()),$.when($this.options.beforePrev.call(this,[currentLink])).done((function(){$this.processContent(content,currentLink),$this.options.onPrev.call(this,[currentLink])}))})),$(".nivo-lightbox-next").off("click").on("click",(function(e){e.preventDefault();var index=galleryItems.index(currentLink);currentLink=galleryItems.eq(index+1),$(currentLink).length||(currentLink=galleryItems.first()),$.when($this.options.beforeNext.call(this,[currentLink])).done((function(){$this.processContent(content,currentLink),$this.options.onNext.call(this,[currentLink])}))}))}setTimeout((function(){lightbox.addClass("nivo-lightbox-open"),$this.options.afterShowLightbox.call(this,[lightbox])}),1)}}}},checkContent:function(link){var $this=this,href=link.attr("href"),video=href.match(/(youtube|youtube-nocookie|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);return null!==href.match(/\.(jpeg|jpg|gif|png)$/i)||(!!video||("ajax"==link.attr("data-lightbox-type")||("#"==href.substring(0,1)&&"inline"==link.attr("data-lightbox-type")||"iframe"==link.attr("data-lightbox-type"))))},processContent:function(content,link){var $this=this,href=link.attr("href"),video=href.match(/(youtube|youtube-nocookie|youtu|vimeo)\.(com|be)\/(watch\?v=([\w-]+)|([\w-]+))/);if(content.html("").addClass("nivo-lightbox-loading"),this.isHidpi()&&link.attr("data-lightbox-hidpi")&&(href=link.attr("data-lightbox-hidpi")),null!==href.match(/\.(jpeg|jpg|gif|png)$/i)){var img=$("<img>",{src:href,class:"nivo-lightbox-image-display"});img.one("load",(function(){var wrap=$('<div class="nivo-lightbox-image" />');wrap.append(img),content.html(wrap).removeClass("nivo-lightbox-loading"),wrap.css({"line-height":$(".nivo-lightbox-content").height()+"px",height:$(".nivo-lightbox-content").height()+"px"}),$(window).resize((function(){wrap.css({"line-height":$(".nivo-lightbox-content").height()+"px",height:$(".nivo-lightbox-content").height()+"px"})}))})).each((function(){this.complete&&$(this).load()})),img.error((function(){var wrap=$('<div class="nivo-lightbox-error"><p>'+$this.options.errorMessage+"</p></div>");content.html(wrap).removeClass("nivo-lightbox-loading")}))}else if(video){var src="",classTerm="nivo-lightbox-video";if("youtube"==video[1]&&(src="//www.youtube.com/embed/"+video[4],classTerm="nivo-lightbox-youtube"),"youtube-nocookie"==video[1]&&(src=href,classTerm="nivo-lightbox-youtube"),"youtu"==video[1]&&(src="//www.youtube.com/embed/"+video[3],classTerm="nivo-lightbox-youtube"),"vimeo"==video[1]&&(src="//player.vimeo.com/video/"+video[3],classTerm="nivo-lightbox-vimeo"),src){var iframeVideo=$("<iframe>",{src:src,class:classTerm,frameborder:0,vspace:0,hspace:0,scrolling:"auto"});content.html(iframeVideo),iframeVideo.load((function(){content.removeClass("nivo-lightbox-loading")}))}}else if("ajax"==link.attr("data-lightbox-type"))$.ajax({url:href,cache:!1,success:function(data){var wrap=$('<div class="nivo-lightbox-ajax" />');wrap.append(data),content.html(wrap).removeClass("nivo-lightbox-loading"),wrap.outerHeight()<content.height()&&wrap.css({position:"relative",top:"50%","margin-top":-wrap.outerHeight()/2+"px"}),$(window).resize((function(){wrap.outerHeight()<content.height()&&wrap.css({position:"relative",top:"50%","margin-top":-wrap.outerHeight()/2+"px"})}))},error:function(){var wrap=$('<div class="nivo-lightbox-error"><p>'+$this.options.errorMessage+"</p></div>");content.html(wrap).removeClass("nivo-lightbox-loading")}});else if("#"==href.substring(0,1)&&"inline"==link.attr("data-lightbox-type"))if($(href).length){var wrap=$('<div class="nivo-lightbox-inline" />');wrap.append($(href).clone().show()),content.html(wrap).removeClass("nivo-lightbox-loading"),wrap.outerHeight()<content.height()&&wrap.css({position:"relative",top:"50%","margin-top":-wrap.outerHeight()/2+"px"}),$(window).resize((function(){wrap.outerHeight()<content.height()&&wrap.css({position:"relative",top:"50%","margin-top":-wrap.outerHeight()/2+"px"})}))}else{var wrapError=$('<div class="nivo-lightbox-error"><p>'+$this.options.errorMessage+"</p></div>");content.html(wrapError).removeClass("nivo-lightbox-loading")}else{if("iframe"!=link.attr("data-lightbox-type"))return!1;var iframe=$("<iframe>",{src:href,class:"nivo-lightbox-item",frameborder:0,vspace:0,hspace:0,scrolling:"auto"});content.html(iframe),iframe.load((function(){content.removeClass("nivo-lightbox-loading")}))}if(link.attr("title")){var titleWrap=$("<span>",{class:"nivo-lightbox-title"});titleWrap.text(link.attr("title")),$(".nivo-lightbox-title-wrap").html(titleWrap)}else $(".nivo-lightbox-title-wrap").html("")},constructLightbox:function(){if($(".nivo-lightbox-overlay").length)return $(".nivo-lightbox-overlay");var overlay=$("<div>",{class:"nivo-lightbox-overlay nivo-lightbox-theme-"+this.options.theme+" nivo-lightbox-effect-"+this.options.effect}),wrap=$("<div>",{class:"nivo-lightbox-wrap"}),content=$("<div>",{class:"nivo-lightbox-content"}),nav=$('<a href="#" class="nivo-lightbox-nav nivo-lightbox-prev">Previous</a><a href="#" class="nivo-lightbox-nav nivo-lightbox-next">Next</a>'),close=$('<a href="#" class="nivo-lightbox-close" title="Close"><i class="icon-close"></i></a>'),title=$("<div>",{class:"nivo-lightbox-title-wrap"}),isMSIE=/*@cc_on!@*/0;wrap.append(content),wrap.append(title),overlay.append(wrap),overlay.append(nav),overlay.append(close),$("body").append(overlay);var $this=this;return $this.options.clickOverlayToClose&&overlay.on("click",(function(e){(e.target===this||$(e.target).hasClass("nivo-lightbox-content")||$(e.target).hasClass("nivo-lightbox-image"))&&$this.destructLightbox()})),$this.options.clickImgToClose&&overlay.on("click",(function(e){(e.target===this||$(e.target).hasClass("nivo-lightbox-image-display"))&&$this.destructLightbox()})),close.on("click",(function(e){e.preventDefault(),$this.destructLightbox()})),overlay},destructLightbox:function(){var $this=this;this.options.beforeHideLightbox.call(this),$(".nivo-lightbox-overlay").removeClass("nivo-lightbox-open"),$(".nivo-lightbox-nav").hide(),$("body").removeClass("nivo-lightbox-body-effect-"+this.options.effect);var isMSIE=/*@cc_on!@*/0;$(".nivo-lightbox-prev").off("click"),$(".nivo-lightbox-next").off("click"),$(".nivo-lightbox-content").empty(),this.options.afterHideLightbox.call(this)},isHidpi:function(){var mediaQuery="(-webkit-min-device-pixel-ratio: 1.5),                              (min--moz-device-pixel-ratio: 1.5),                              (-o-min-device-pixel-ratio: 3/2),                              (min-resolution: 1.5dppx)";return window.devicePixelRatio>1||!(!window.matchMedia||!window.matchMedia(mediaQuery).matches)}},$.fn[pluginName]=function(options){return this.each((function(){$.data(this,pluginName)||$.data(this,pluginName,new NivoLightbox(this,options))}))}}(jQuery,window,document);